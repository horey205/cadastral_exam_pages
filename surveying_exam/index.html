<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ì¸¡ëŸ‰ë°ì§€í˜•ê³µê°„ì •ë³´ì‚°ì—…ê¸°ì‚¬ ê¸°ì¶œì •ë³µ</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Outfit:wght@500;700&display=swap"
        rel="stylesheet">
</head>

<body class="dark-mode" style="overflow:hidden"> <!-- ë¡œê·¸ì¸ ì „ ìŠ¤í¬ë¡¤ ë°©ì§€ -->
    <!-- User Login Overlay -->
    <div id="user-login-overlay" class="screen"
        style="display: flex; align-items: center; justify-content: center; position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 9999; background: var(--background);">
        <div class="glass card" style="width: 90%; max-width: 320px; padding: 30px; text-align: center;">
            <h2 style="margin-bottom: 30px;">ì¸¡ëŸ‰ë°ì§€í˜•ê³µê°„ì •ë³´ì‚°ì—…ê¸°ì‚¬<br>ê¸°ì¶œë¬¸ì œ</h2>
            <div class="form-group" style="text-align: left; margin-bottom:15px">
                <label style="display:block; color:var(--text-muted); font-size:0.8rem; margin-bottom:5px">ID</label>
                <input type="text" id="user-id" placeholder="ID ì…ë ¥"
                    style="width:100%; padding:10px; border-radius:8px; background:rgba(255,255,255,0.05); border:1px solid var(--glass-border); color:white; font-size: 16px;">
            </div>
            <div class="form-group" style="text-align: left; margin-bottom: 30px;">
                <label
                    style="display:block; color:var(--text-muted); font-size:0.8rem; margin-bottom:5px">Password</label>
                <input type="password" id="user-pw" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥"
                    style="width:100%; padding:10px; border-radius:8px; background:rgba(255,255,255,0.05); border:1px solid var(--glass-border); color:white; font-size: 16px;">
            </div>
            <button class="primary-btn" style="width: 100%;" onclick="checkUserLogin()">ì ‘ì†í•˜ê¸°</button>
            <p id="user-login-error" style="color: #ef4444; font-size: 0.8rem; margin-top: 15px; min-height:1.2em;"></p>
        </div>
    </div>

    <div id="app" class="hidden"> <!-- ì´ˆê¸°ì—ëŠ” ìˆ¨ê¹€ ì²˜ë¦¬ -->
        <!-- Landing Section -->
        <section id="landing" class="screen">
            <div class="hero">
                <h1>ì¸¡ëŸ‰ë°ì§€í˜•ê³µê°„ì •ë³´ì‚°ì—…ê¸°ì‚¬ <span class="gradient-text">ê¸°ì¶œì •ë³µ</span></h1>
                <p>2012ë…„ ~ 2020ë…„ ì „íšŒì°¨ ê¸°ì¶œë¬¸ì œ (ì•½ 2,000ë¬¸í•­)</p>

                <div class="source-selector glass"
                    style="display: inline-flex; padding: 5px; margin-bottom: 30px; border-radius: 12px;">
                    <button id="src-official" class="tab-btn active" onclick="setSource('ê¸°ì¶œ')">ê¸°ì¶œë¬¸ì œ</button>
                    <button id="src-all" class="tab-btn" onclick="setSource('all')">ì „ì²´</button>
                </div>

                <div class="subject-grid">
                    <!-- 1ê³¼ëª© -->
                    <div class="subject-card glass">
                        <h4>ğŸ“ ì¸¡ëŸ‰í•™</h4>
                        <div class="button-group">
                            <button class="primary-btn" onclick="startQuiz('ì¸¡ëŸ‰í•™', 'study')">í•™ìŠµí•˜ê¸°</button>
                            <button class="glass-btn" onclick="startQuiz('ì¸¡ëŸ‰í•™', 'exam')">ëª¨ì˜ê³ ì‚¬</button>
                        </div>
                    </div>

                    <!-- 2ê³¼ëª© -->
                    <div class="subject-card glass">
                        <h4>ğŸ›°ï¸ ì‚¬ì§„ì¸¡ëŸ‰ ë° ì›ê²©íƒì‚¬</h4>
                        <div class="button-group">
                            <button class="primary-btn" onclick="startQuiz('ì‚¬ì§„ì¸¡ëŸ‰', 'study')">í•™ìŠµí•˜ê¸°</button>
                            <button class="glass-btn" onclick="startQuiz('ì‚¬ì§„ì¸¡ëŸ‰', 'exam')">ëª¨ì˜ê³ ì‚¬</button>
                        </div>
                    </div>

                    <!-- 3ê³¼ëª© -->
                    <div class="subject-card glass">
                        <h4>ğŸ—ºï¸ GIS ë° GPS</h4>
                        <div class="button-group">
                            <button class="primary-btn" onclick="startQuiz('GIS', 'study')">í•™ìŠµí•˜ê¸°</button>
                            <button class="glass-btn" onclick="startQuiz('GIS', 'exam')">ëª¨ì˜ê³ ì‚¬</button>
                        </div>
                    </div>

                    <!-- 4ê³¼ëª© -->
                    <div class="subject-card glass">
                        <h4>ğŸ—ï¸ ì‘ìš©ì¸¡ëŸ‰</h4>
                        <div class="button-group">
                            <button class="primary-btn" onclick="startQuiz('ì‘ìš©ì¸¡ëŸ‰', 'study')">í•™ìŠµí•˜ê¸°</button>
                            <button class="glass-btn" onclick="startQuiz('ì‘ìš©ì¸¡ëŸ‰', 'exam')">ëª¨ì˜ê³ ì‚¬</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="stats-overview">
                <div class="stat-card glass">
                    <span class="val" id="total-q-count">100</span>
                    <span class="lbl">ì´ ë¬¸í•­ ìˆ˜</span>
                </div>
                <div class="stat-card glass">
                    <span class="val">1ë¶„</span>
                    <span class="lbl">ë¬¸í•­ë‹¹ ì œí•œì‹œê°„</span>
                </div>
            </div>
            <div style="margin-top: 40px; text-align: center;">
                <a href="../LicesneExam/index.html" class="glass-btn"
                    style="text-decoration: none; font-size: 0.9rem;">ì§€ì ê³µë¬´ì› ê¸°ì¶œë¡œ ì´ë™</a>
            </div>
        </section>

        <!-- Quiz Section -->
        <section id="quiz" class="screen hidden">
            <div class="quiz-header glass">
                <button class="back-btn" onclick="showLanding()">âœ•</button>
                <div class="progress-box">
                    <div class="progress-container">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <span id="q-counter" class="counter">1 / 20</span>
                </div>
                <div class="timer" id="timer">01:00</div>
            </div>

            <div class="question-container">
                <div id="question-card" class="glass card">
                    <div class="q-meta">
                        <div>
                            <span id="curr-subject" class="tag">ë²”ìœ„</span>
                            <span id="curr-num" class="q-id">ë¬¸ 1.</span>
                        </div>
                        <span id="q-date" class="q-date" style="font-size: 0.8rem; color: var(--text-muted);">2020. 8.
                            22.</span>
                    </div>
                    <div id="q-text" class="q-content">
                        ì§ˆë¬¸ ë‚´ìš©
                    </div>
                    <div id="q-image" class="q-image hidden">
                        <!-- Image injected here -->
                    </div>
                    <div class="options" id="options">
                        <!-- Options injected here -->
                    </div>

                    <!-- Explanation Box -->
                    <div id="explanation" class="explanation-box hidden">
                        <div class="exp-header">ğŸ’¡ í•´ì„¤</div>
                        <div id="exp-text" class="exp-content"></div>
                    </div>
                </div>
            </div>

            <div class="action-footer">
                <button id="next-btn" class="primary-btn hidden" onclick="nextQuestion()">ë‹¤ìŒ ë¬¸ì œ</button>
            </div>
        </section>

        <!-- Result Section -->
        <section id="result" class="screen hidden">
            <div class="result-card glass">
                <h2 id="result-title">í‰ê°€ ì™„ë£Œ!</h2>
                <div class="score-display">
                    <div class="donut-chart">
                        <span id="final-score">0</span>
                        <small>/ 100</small>
                    </div>
                </div>
                <div class="result-stats">
                    <p>ì •ë‹µ: <span id="correct-count">0</span> / <span id="total-questions">0</span> ë¬¸í•­</p>
                </div>
                <div class="result-actions">
                    <button class="glass-btn btn-full" onclick="showLanding()">í™ˆìœ¼ë¡œ</button>
                </div>
            </div>
        </section>
    </div>

    <!-- Scripts -->
    <script src="questions.js"></script>
    <script src="script.js"></script>
    <script>
        async function sha256(message) {
            const msgBuffer = new TextEncoder().encode(message);
            const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }

        async function checkUserLogin() {
            const id = document.getElementById('user-id').value;
            const pw = document.getElementById('user-pw').value;
            const err = document.getElementById('user-login-error');

            // í•´ì‹œê°’ (ID: user, PW: user2685)
            const validIdHash = "04f8996da763b7a969b1028ee3007569eaf3a635486ddab211d512c85b9df8fb";
            const validPwHash = "2ce7c4e813cdec5d49d684e60c591c24f5ad0c3d1e174fe9fd5cb7161047983d";

            try {
                const idHash = await sha256(id);
                const pwHash = await sha256(pw);

                if (idHash === validIdHash && pwHash === validPwHash) {
                    document.getElementById('user-login-overlay').classList.add('hidden');
                    document.getElementById('app').classList.remove('hidden');
                    document.body.style.overflow = ''; // ìŠ¤í¬ë¡¤ ë³µì›
                } else {
                    err.innerText = "ì •ë³´ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.";
                    document.getElementById('user-pw').value = '';
                    document.getElementById('user-pw').focus();
                }
            } catch (e) {
                console.error("Login Error:", e);
                err.innerText = "ë¡œê·¸ì¸ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (HTTPS í™˜ê²½ í•„ìš”)";
            }
        }

        // ì—”í„°í‚¤ ë¡œê·¸ì¸ ì§€ì›
        document.getElementById('user-pw').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') checkUserLogin();
        });
        document.getElementById('user-id').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') document.getElementById('user-pw').focus();
        });
    </script>
</body>

</html>